# PHI Detection Patterns
# These patterns are used by the PHI detection service to identify and redact
# Protected Health Information (PHI) from text content.

contact:
  - name: "US Phone Number"
    pattern: "\\(?(\\d{3})\\)?[-. ]?(\\d{3})[-. ]?(\\d{4})"
    description: "US phone number with or without formatting"
  
  - name: "Email Address"
    pattern: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
    description: "Email address"

name:
  - name: "Full Name"
    pattern: "(?:[A-Z][a-z]+\\s+){1,2}[A-Z][a-z]+"
    description: "Full name with 2-3 parts"
  
  - name: "Dr. Name Pattern"
    pattern: "Dr\\.?\\s+[A-Z][a-z]+"
    description: "Doctor name with title"

government_id:
  - name: "SSN"
    pattern: "\\d{3}[-\\s]?\\d{2}[-\\s]?\\d{4}"
    description: "Social Security Number"
  
  - name: "Medical Record Number"
    pattern: "MRN:?\\s*\\d{5,10}"
    description: "Medical Record Number"

location:
  - name: "US Address"
    pattern: "\\d+\\s+[A-Za-z\\s]+,\\s+[A-Za-z\\s]+,\\s+[A-Z]{2}\\s+\\d{5}"
    description: "US street address"
  
  - name: "Zip Code"
    pattern: "\\b\\d{5}(?:-\\d{4})?\\b"
    description: "US ZIP code with optional +4"

date:
  - name: "Date (MM/DD/YYYY)"
    pattern: "\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4}"
    description: "Date in MM/DD/YYYY format"
  
  - name: "Date (Month DD, YYYY)"
    pattern: "(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]*\\s+\\d{1,2},?\\s+\\d{4}"
    description: "Date in Month DD, YYYY format"

financial:
  - name: "Credit Card"
    pattern: "\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}"
    description: "Credit card number"
  
  - name: "Bank Account"
    pattern: "Acct\\.?\\s*#?\\s*\\d{8,17}"
    description: "Bank account number"

medical:
  - name: "ICD-10 Code"
    pattern: "[A-Z]\\d{2}(?:\\.\\d{1,2})?"
    description: "ICD-10 diagnostic code"
  
  - name: "Healthcare Provider"
    pattern: "(?:Doctor|Dr|Physician|Psychiatrist|Psychologist|Therapist|Counselor)\\s+[A-Z][a-z]+"
    description: "Healthcare provider reference"
  
  - name: "Medication"
    pattern: "(?:prescribe|take|using|on)\\s+\\d+\\s*mg\\s+of\\s+[A-Za-z]+"
    description: "Medication reference with dosage"